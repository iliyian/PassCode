# 校园通行码预约管理系统

## 项目简介

校园通行码预约管理系统是一个基于Java Web技术开发的校园访客管理系统，支持社会公众预约和公务预约两种模式，采用国密算法保障数据安全，符合等保三级安全要求。

## 功能特性

### 手机端功能
- **我要预约**: 支持社会公众预约和公务预约申请
- **我的预约**: 查询历史预约记录和通行码
- **通行码展示**: 动态生成二维码通行码，支持有效/无效状态显示

### 管理端功能
- **管理员管理**: 支持系统管理员、学校管理员、部门管理员、审计管理员四种角色
- **部门管理**: 行政部门、直属部门、学院的管理
- **预约管理**: 社会公众预约和公务预约的查询、审核、统计
- **安全审计**: 完整的操作日志记录和审计功能

## 技术架构

### 后端技术
- **Java 21**: 主要开发语言
- **Jakarta Servlet**: Web框架
- **MySQL 8.0**: 数据库
- **JDBC**: 数据库连接
- **ZXing**: 二维码生成

### 安全特性
- **国密算法**: SM3哈希、SM4加密
- **密码策略**: 复杂度要求、定期更换、失败锁定
- **数据脱敏**: 敏感信息显示保护
- **访问控制**: 基于角色的权限管理
- **安全审计**: 操作日志记录和完整性保护

## 项目结构

```
src/
├── main/
│   ├── java/
│   │   └── com/zjut/passcode/
│   │       ├── bean/           # 实体类
│   │       ├── controller/     # 控制器
│   │       ├── dao/           # 数据访问层
│   │       └── util/          # 工具类
│   └── webapp/
│       ├── admin/             # 管理端页面
│       ├── WEB-INF/
│       └── *.jsp             # 前端页面
├── database_init.sql         # 数据库初始化脚本
└── README.md                # 项目说明
```

## 数据库设计

### 核心表结构
1. **department**: 部门信息表
2. **admin**: 管理员信息表
3. **appointment**: 预约记录表
4. **accompanying_person**: 随行人员表
5. **audit_log**: 安全审计日志表

### 安全特性
- 密码使用SM3哈希存储
- 身份证号、手机号使用SM4加密存储
- 日志使用HMAC-SM3完整性保护
- 自动清理180天前的审计日志

## 部署说明

### 环境要求
- JDK 21+
- MySQL 8.0+
- Maven 3.6+
- Tomcat 10+

### 部署步骤

1. **数据库初始化**
   ```bash
   mysql -u root -p < database_init.sql
   ```

2. **配置数据库连接**
   修改DAO类中的数据库连接信息：
   ```java
   private static final String DB_URL = "jdbc:mysql://localhost:3306/campus_pass?useSSL=false&serverTimezone=UTC";
   private static final String DB_USER = "your_username";
   private static final String DB_PASSWORD = "your_password";
   ```

3. **编译部署**
   ```bash
   mvn clean package
   # 将生成的war包部署到Tomcat
   ```

4. **访问系统**
   - 首页: http://localhost:8080/PassCode/
   - 管理员登录: http://localhost:8080/PassCode/admin/login

### 默认管理员账户
- 用户名: admin
- 密码: Admin@123
- 角色: 系统管理员

## 安全配置

### 密码策略
- 最小长度: 8位
- 复杂度要求: 数字、大小写字母、特殊字符
- 过期时间: 90天
- 失败锁定: 5次失败锁定30分钟

### 会话管理
- 超时时间: 30分钟
- 自动退出: 超时自动退出

### 数据保护
- 敏感信息加密存储
- 页面显示脱敏处理
- 操作日志完整记录

## 功能演示

### 预约流程
1. 访问首页，点击"我要预约"
2. 填写预约信息（基本信息、预约信息、预约类型）
3. 提交申请，系统自动审核或等待部门审核
4. 查看通行码，向门卫出示

### 管理流程
1. 管理员登录系统
2. 查看待审核的公务预约
3. 审核通过或拒绝
4. 查看统计数据和审计日志

## 开发说明

### 代码规范
- 遵循MVC架构模式
- 使用DAO模式进行数据访问
- 统一的异常处理和日志记录
- 完整的注释和文档

### 扩展功能
- 支持添加新的预约类型
- 支持自定义审核流程
- 支持集成第三方认证
- 支持移动端APP开发

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 联系方式

如有问题或建议，请联系开发团队。

---

**注意**: 本系统仅用于学习和演示目的，生产环境使用前请进行充分的安全测试和配置调整。 